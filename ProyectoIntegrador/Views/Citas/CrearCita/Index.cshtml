@model ProyectoIntegrador.Controllers.Citas.DTOs.CrearCitaDTO
@{

    ViewBag.Title = "Crear Cita";
    ProyectoIntegrador.Models.DBModels.Empleado empleado = Session["empleado"] != null ? (ProyectoIntegrador.Models.DBModels.Empleado)Session["empleado"] : null;
}

<style>
    .hourColumn{
        width: 80px;
    }

    .seleccionable:hover {
        background-color: antiquewhite;
    }

    .seleccionable:active {
        background-color: bisque;
    }

    .no-seleccionable {
        background-color: darkgray;
    }

    .seleccionada {
        background-color: coral;
    }

        .seleccionada:active {
            background-color: darkorange;
        }


</style>

<h4 class="titlePage mb-4">Citas</h4>
@using (Html.BeginForm())
{
    @Html.AntiForgeryToken()
    <div class="card cardField mb-4">
        <div class="card-body">
            <h6 class="card-title"> Datos Afiliado </h6>
            <div class="form-row">
                <div class="form-group col-3">
                    <label>Tipo Identificacion</label>
                    @Html.DropDownListFor(m => m.Afiliado.PersonaF.IdentificacionTipoF, new SelectList(Model.TiposIdentificaciones.Select(o => new { Value = o.Id, Text = o.Nombre }), "Value", "Text"), "Seleccione...", htmlAttributes: new { @class = "form-control", element = "afiliadoTipodentificacion" })
                </div>
                <div class="form-group col-3">
                    <label>Número de Identificación</label>
                    @Html.EditorFor(m => m.Afiliado.PersonaF.IdentificacionNumero, new { htmlAttributes = new { @class = "form-control", placeholder = "Ingrese número identificación", numbermask = "", element = "afiliadoNumeroIdentificacion" } })
                </div>
            </div>
            <div class="form-row">
                <div class="form-group col-6">
                    <label>Nombres</label>
                    <input type="text" element="afiliadoNombres" value="@Model.Afiliado.PersonaF.Nombres" class="form-control" disabled />
                </div>
                <div class="form-group col-3">
                    <label>Primer Apellido</label>
                    <input type="text" element="afiliadoPrimerApellido" value="@Model.Afiliado.PersonaF.PrimerApellido" class="form-control" disabled />
                </div>
                <div class="form-group col-3">
                    <label>Segundo Apellido</label>
                    <input type="text" element="afiliadoSegundoApellido" value="@Model.Afiliado.PersonaF.SegundoApellido" class="form-control" disabled />
                </div>
                <div class="form-group col-3">
                    <label>Genero</label>
                    <input type="text" element="afiliadoGenero" value="@Model.Afiliado.PersonaF.GeneroF.Nombre" class="form-control" disabled />
                </div>
                <div class="form-group col-6">
                    <label>Recidencia</label>
                    <input type="text" element="afiliadoRecidencia" value="@Model.Afiliado.RecidenciaMunicipioF.Nombre - @Model.Afiliado.RecidenciaMunicipioF.DepartamentoF.Nombre" class="form-control" disabled />
                </div>
            </div>
        </div>
    </div>

    <div class="card cardField mb-4">
        <div class="card-body">
            <h6 class="card-title"> Datos Cita </h6>
            <div class="form-row">
                <div class="form-group col-3">
                    <label>Tipo Procedimiento</label>
                    @Html.DropDownListFor(m => m.TipoCita.Id, new SelectList(Model.TiposCitas.Select(o => new { Value = o.Codigo, Text = o.Nombre }), "Value", "Text"), "Seleccione...", htmlAttributes: new { @class = "form-control", element = "tipoCita" })
                </div>
            </div>

            <!-- =======================AGENDAMIENTO CITA VACUNA COVID======================= -->
            <div id="vacunaCovid" class="container-fluid d-none" element="vacunaCovidBloque" style="padding-left: 0px; padding-right: 0px;">
                <div class="form-group row">
                    <label class="col-3 col-form-label">Sucursal Usuario Actual</label>
                    <div class="col-9">
                        @if (empleado != null)
                        {
                            <input type="text" value="@Html.Raw(empleado.SucursalF.Nombre + " - " + empleado.SucursalF.Direccion + " [" + empleado.SucursalF.MunicipioF.Nombre + " - " + empleado.SucursalF.MunicipioF.DepartamentoF.Nombre + "]")" class="form-control" disabled />
                        }
                        else
                        {
                            <input type="text" value="El usuario no tine un registro de empleado asociado, no hay datos de sucursal al cual asociar la cita" class="form-control" disabled />
                        }
                    </div>
                </div>
                @if (empleado != null)
                {
                    <div class="form-group row">
                        <label class="col-3 col-form-label">Sucursal Cita</label>
                        <div class="col-9">
                            <select element="sucursalCita" name="sucursalCita" data="sucursalCita" class="form-control">
                                @foreach (ProyectoIntegrador.Models.DBModels.Sucursal sucursal in Model.Sucursulas)
                                {
                                    <option value="@sucursal.Id" @if (@sucursal.Id.Equals(Model.SucursalEmpleado.Id)) { @Html.Raw("selected") }>
                                        @sucursal.NombreCompleto
                                    </option>
                                }
                            </select>
                        </div>
                    </div>
                }
                <div class="form-group row">
                    <label class="col-3 col-form-label">Fecha</label>
                    <div class="col-4">
                        <input type="date" element="fechaCita" class="form-control" id="fechaCita" />
                    </div>
                </div>
                <button type="button" class="form-control btn btn-primary" element="btnConsultarEspacioCovid">Consultar</button>
                <div class="mt-3" element="agendaCovidContainer">
                    <!-- Contenido por JS -->
                </div>
                <button type="button" class="form-control btn btn-primary d-none" element="btnConfirmarCitaCovid">Agendar</button>
            </div>
            <!-- =======================AGENDAMIENTO CITA VACUNA COVID======================= -->


        </div>
    </div>
}


@Scripts.Render("~/Scripts/Citas/CrearCita.js")
<script type="text/javascript">
    this.view.coreData = @Html.Raw(Json.Encode(Model));
</script>